<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="description" content="DARTSLIVEÊàêÁ∏æË®òÈå≤„ÉªÂàÜÊûê„Ç¢„Éó„É™ - ÊØéÊó•„ÅÆ„Çπ„Çø„ÉÉ„ÉÑ„ÇíËìÑÁ©ç„Åó„ÄÅÂÖ®Â±•Ê≠¥„ÇíÂèÇÁÖß„ÉªÂàÜÊûê">
    <title>üéØ Darts Stats Log</title>

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#00ffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="DartsStats">

    <!-- Canonical (iOS share / Add to Home ScreenÂØæÁ≠ñ) -->
    <link rel="canonical" href="https://katsumuro.github.io/darts-stats-log/">

    <!-- Icons -->
    <link rel="icon" type="image/png" href="icons/icon-192.png">
    <link rel="apple-touch-icon" href="icons/icon-192.png">

    <!-- Manifest (GitHub Pages project siteÈÖç‰∏ã„ÇíÊòéÁ§∫) -->
    <link rel="manifest" href="/darts-stats-log/manifest.json">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@500;700&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="css/index.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('Service Worker registered:', reg.scope))
                    .catch(err => console.log('Service Worker registration failed:', err));
            });
        }
    </script>
</head>

<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-brand">
                <span class="header-icon">üéØ</span>
                <h1 class="header-title">Darts Stats Log</h1>
            </div>
            <nav class="nav">
                <button class="nav-btn active" data-page="home">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-label">Home</span>
                </button>
                <button class="nav-btn" data-page="history">
                    <span class="nav-icon">üìã</span>
                    <span class="nav-label">Â±•Ê≠¥</span>
                </button>
                <button class="nav-btn" data-page="analytics">
                    <span class="nav-icon">üìä</span>
                    <span class="nav-label">ÂàÜÊûê</span>
                </button>
                <button class="nav-btn" data-page="settings">
                    <span class="nav-icon">‚öôÔ∏è</span>
                    <span class="nav-label">Ë®≠ÂÆö</span>
                </button>
            </nav>
        </header>

        <!-- Main Content -->
        <main class="main">
            <!-- Home Page (Dashboard) -->
            <section id="page-home" class="page active">
                <!-- Main Rating Display -->
                <div class="dashboard-header">
                    <div class="main-rating-container">
                        <div class="rating-ring">
                            <svg viewBox="0 0 120 120" class="rating-gauge">
                                <defs>
                                    <linearGradient id="rating-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" style="stop-color:#00d4ff;stop-opacity:1" />
                                        <stop offset="20%" style="stop-color:#00ffcc;stop-opacity:1" />
                                        <stop offset="40%" style="stop-color:#88ff00;stop-opacity:1" />
                                        <stop offset="60%" style="stop-color:#ffdd00;stop-opacity:1" />
                                        <stop offset="80%" style="stop-color:#ff8800;stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#ff0044;stop-opacity:1" />
                                    </linearGradient>
                                </defs>
                                <circle cx="60" cy="60" r="54" class="gauge-bg" />
                                <circle cx="60" cy="60" r="54" class="gauge-fill" id="rating-gauge-fill" />
                            </svg>
                            <div class="rating-center">
                                <input type="number" class="main-rating-input" id="main-rating-input" placeholder="--"
                                    step="0.01" min="0" max="18">
                            </div>
                        </div>
                        <div class="rating-rank" id="rating-rank">--</div>
                    </div>
                </div>

                <!-- Game Stats Row -->
                <div class="game-stats-row">
                    <div class="game-stat-item" data-game="01">
                        <span class="game-stat-label">01 GAMES</span>
                        <span class="game-stat-value" id="stat-01">--</span>
                    </div>
                    <div class="game-stat-item" data-game="cricket">
                        <span class="game-stat-label">CRICKET</span>
                        <span class="game-stat-value" id="stat-cricket">--</span>
                    </div>
                    <div class="game-stat-item" data-game="countup">
                        <span class="game-stat-label">COUNT-UP</span>
                        <span class="game-stat-value" id="stat-countup">--</span>
                    </div>
                </div>

                <!-- Rating Chart -->
                <div class="dashboard-chart">
                    <div class="chart-header">
                        <span class="chart-title">STATS / 30 days</span>
                    </div>
                    <div class="chart-container-small">
                        <canvas id="dashboard-chart"></canvas>
                    </div>
                </div>

                <!-- Today's Record Button -->
                <div class="today-action">
                    <button id="btn-create-session" class="btn btn-primary btn-large btn-block">
                        <span class="btn-icon">‚ûï</span>
                        <span id="today-btn-text">‰ªäÊó•„ÅÆË®òÈå≤„Çí‰ΩúÊàê</span>
                    </button>
                </div>

                <!-- Quick Stats -->
                <div class="stats-grid-small">
                    <div class="stat-card-small">
                        <span class="stat-label-small">‰ªäÊúà</span>
                        <span class="stat-value-small" id="stat-month-sessions">0</span>
                    </div>
                    <div class="stat-card-small">
                        <span class="stat-label-small">ÈÄ£Á∂ö</span>
                        <span class="stat-value-small" id="stat-streak">0</span>
                    </div>
                </div>
            </section>

            <!-- Session Editor Page -->
            <section id="page-session-editor" class="page">
                <div class="page-header">
                    <button class="btn btn-ghost btn-back" id="btn-back-from-editor">
                        ‚Üê Êàª„Çã
                    </button>
                    <h2>„Çª„ÉÉ„Ç∑„Éß„É≥Á∑®ÈõÜ</h2>
                    <button class="btn btn-primary" id="btn-save-session">‰øùÂ≠ò</button>
                </div>

                <div class="editor-content">
                    <!-- Session Info -->
                    <div class="card">
                        <div class="card-header">
                            <h3>„Çª„ÉÉ„Ç∑„Éß„É≥ÊÉÖÂ†±</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">Êó•‰ªò</label>
                                <div class="date-readonly" id="editor-date"></div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Â†¥ÊâÄ</label>
                                <input type="text" class="form-input" id="editor-location" placeholder="‰æã: „É©„Ç¶„É≥„Éâ„ÉØ„É≥Êñ∞ÂÆø">
                            </div>
                            <div class="form-group">
                                <label class="form-label">„É°„É¢</label>
                                <textarea class="form-textarea" id="editor-memo"
                                    placeholder="‰ªäÊó•„ÅÆË™øÂ≠ê„ÇÑÊ∞ó„Å•„Åç„ÇíË®òÈå≤..."></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">„Çø„Ç∞</label>
                                <div class="tags-input-container">
                                    <div class="tags-list" id="editor-tags"></div>
                                    <input type="text" class="form-input tags-input" id="editor-tag-input"
                                        placeholder="„Çø„Ç∞„ÇíËøΩÂä† (Enter)">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- StatBlocks -->
                    <div class="card">
                        <div class="card-header">
                            <h3>„Çπ„Çø„ÉÉ„ÉÑ</h3>
                            <button class="btn btn-secondary" id="btn-add-statblock">
                                ‚ûï „Ç≤„Éº„É†ËøΩÂä†
                            </button>
                        </div>
                        <div class="card-body" id="statblocks-container">
                            <!-- StatBlocks will be rendered here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- History Page -->
            <section id="page-history" class="page">
                <div class="page-header">
                    <h2>Â±•Ê≠¥</h2>
                    <div class="view-toggle">
                        <button class="toggle-btn active" data-view="list">„É™„Çπ„Éà</button>
                        <button class="toggle-btn" data-view="calendar">„Ç´„É¨„É≥„ÉÄ„Éº</button>
                    </div>
                </div>

                <!-- Filters -->
                <div class="filters-bar">
                    <select class="form-select" id="filter-period">
                        <option value="all">ÂÖ®ÊúüÈñì</option>
                        <option value="7">ÈÅéÂéª7Êó•</option>
                        <option value="30">ÈÅéÂéª30Êó•</option>
                        <option value="90">ÈÅéÂéª90Êó•</option>
                    </select>
                    <select class="form-select" id="filter-game-type">
                        <option value="all">ÂÖ®„Ç≤„Éº„É†</option>
                        <option value="COUNTUP">COUNT UP</option>
                        <option value="01">01</option>
                        <option value="CRICKET">CRICKET</option>
                        <option value="OTHER">OTHER</option>
                    </select>
                </div>

                <!-- List View -->
                <div id="history-list-view" class="history-view active">
                    <div class="history-list" id="history-list">
                        <!-- Sessions will be rendered here -->
                    </div>
                </div>

                <!-- Calendar View -->
                <div id="history-calendar-view" class="history-view">
                    <div class="calendar-header">
                        <button class="btn btn-ghost" id="calendar-prev">‚óÄ</button>
                        <span class="calendar-month" id="calendar-month"></span>
                        <button class="btn btn-ghost" id="calendar-next">‚ñ∂</button>
                    </div>
                    <div class="calendar-grid" id="calendar-grid">
                        <!-- Calendar will be rendered here -->
                    </div>
                </div>
            </section>

            <!-- Analytics Page -->
            <section id="page-analytics" class="page">
                <div class="page-header">
                    <h2>ÂàÜÊûê</h2>
                </div>

                <!-- Period Selector -->
                <div class="period-selector">
                    <button class="period-btn" data-period="7">7Êó•</button>
                    <button class="period-btn active" data-period="30">30Êó•</button>
                    <button class="period-btn" data-period="90">90Êó•</button>
                    <button class="period-btn" data-period="all">ÂÖ®ÊúüÈñì</button>
                </div>

                <!-- Metric Selector -->
                <div class="metric-selector">
                    <select class="form-select" id="analytics-metric">
                        <option value="rating01">01 Rating (Âπ≥Âùá)</option>
                        <option value="mpr">CRICKET MPR (Âπ≥Âùá)</option>
                        <option value="countup">COUNT-UP „Çπ„Ç≥„Ç¢ (Âπ≥Âùá)</option>
                        <option value="dartslive">DARTSLIVE „É¨„Éº„ÉÜ„Ç£„É≥„Ç∞</option>
                    </select>
                </div>

                <!-- Chart -->
                <div class="chart-container">
                    <canvas id="analytics-chart"></canvas>
                </div>

                <!-- Summary Stats -->
                <div class="summary-stats">
                    <div class="summary-card">
                        <span class="summary-label">„Éô„Çπ„Éà</span>
                        <span class="summary-value" id="summary-best">--</span>
                    </div>
                    <div class="summary-card">
                        <span class="summary-label">Âπ≥Âùá</span>
                        <span class="summary-value" id="summary-avg">--</span>
                    </div>
                    <div class="summary-card">
                        <span class="summary-label">ÊúÄÊñ∞</span>
                        <span class="summary-value" id="summary-latest">--</span>
                    </div>
                </div>
            </section>

            <!-- Settings Page -->
            <section id="page-settings" class="page">
                <div class="page-header">
                    <h2>Ë®≠ÂÆö</h2>
                </div>

                <div class="settings-content">
                    <!-- Export -->
                    <div class="card">
                        <div class="card-header">
                            <h3>„Éá„Éº„ÇøÁÆ°ÁêÜ</h3>
                        </div>
                        <div class="card-body">
                            <button class="btn btn-primary btn-block" id="btn-export">
                                üì§ JSON„Ç®„ÇØ„Çπ„Éù„Éº„Éà
                            </button>
                            <button class="btn btn-secondary btn-block" id="btn-import">
                                üì• JSON„Ç§„É≥„Éù„Éº„Éà
                            </button>
                            <input type="file" id="import-file" accept=".json" style="display: none;">
                        </div>
                    </div>

                    <!-- Theme -->
                    <div class="card">
                        <div class="card-header">
                            <h3>„ÉÜ„Éº„Éû</h3>
                        </div>
                        <div class="card-body">
                            <div class="theme-options">
                                <button class="theme-btn active" data-accent="cyan"
                                    style="--accent-preview: #00ffff;"></button>
                                <button class="theme-btn" data-accent="magenta"
                                    style="--accent-preview: #ff00ff;"></button>
                                <button class="theme-btn" data-accent="lime"
                                    style="--accent-preview: #00ff00;"></button>
                                <button class="theme-btn" data-accent="orange"
                                    style="--accent-preview: #ff8800;"></button>
                                <button class="theme-btn" data-accent="pink"
                                    style="--accent-preview: #ff66b2;"></button>
                            </div>
                        </div>
                    </div>

                    <!-- About -->
                    <div class="card">
                        <div class="card-header">
                            <h3>About</h3>
                        </div>
                        <div class="card-body">
                            <p class="about-text">Darts Stats Log v1.0</p>
                            <p class="about-text muted">DARTSLIVEÊàêÁ∏æË®òÈå≤„ÉªÂàÜÊûê„Ç¢„Éó„É™</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- StatBlock Modal -->
        <div class="modal" id="modal-statblock">
            <div class="modal-overlay"></div>
            <div class="modal-content">
                <div class="modal-header">
                    <h3>„Ç≤„Éº„É†ËøΩÂä†</h3>
                    <button class="btn btn-ghost modal-close">‚úï</button>
                </div>
                <div class="modal-body">
                    <!-- Game Type Selection -->
                    <div class="game-type-grid" id="game-type-grid">
                        <button class="game-type-btn" data-type="01">
                            <span class="game-icon">üéØ</span>
                            <span class="game-name">01 GAMES</span>
                        </button>
                        <button class="game-type-btn" data-type="CRICKET">
                            <span class="game-icon">ü¶ã</span>
                            <span class="game-name">CRICKET</span>
                        </button>
                        <button class="game-type-btn" data-type="COUNTUP">
                            <span class="game-icon">üíØ</span>
                            <span class="game-name">COUNT-UP</span>
                        </button>
                        <button class="game-type-btn" data-type="OTHER">
                            <span class="game-icon">üìù</span>
                            <span class="game-name">OTHER</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Session Detail Modal -->
        <div class="modal" id="modal-session-detail">
            <div class="modal-overlay"></div>
            <div class="modal-content modal-large">
                <div class="modal-header">
                    <h3 id="detail-date">„Çª„ÉÉ„Ç∑„Éß„É≥Ë©≥Á¥∞</h3>
                    <button class="btn btn-ghost modal-close">‚úï</button>
                </div>
                <div class="modal-body" id="session-detail-content">
                    <!-- Session detail will be rendered here -->
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="btn-edit-session">Á∑®ÈõÜ</button>
                    <button class="btn btn-danger" id="btn-delete-session">ÂâäÈô§</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/db.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/components.js"></script>
    <script src="js/app.js"></script>
</body>

</html>